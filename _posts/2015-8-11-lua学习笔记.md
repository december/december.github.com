---
layout: post
category: 技术
tags: lua 脚本 元组
description: 学习写lua语言，理解其面向对象机制和类的实现
---

### 关于lua语言

  * 一种小巧的脚本语言，由C编写而成，具备良好的跨平台特性
  * 由于缺乏强大的库，不适合用来独立开发程序
  * 便于被C代码调用以及调用C。
  * 效率最高的脚本语言

### 语法学习笔记

  * 数组下标从1开始
  * 数组中允许用逗号结尾
  * 大小写敏感，分号可有可无
  * 用nil表示空，没有Null和null
  * 只有nil和false是逻辑的false，包括数字0和空字符串在内的其它变量均为true
  * 循环语句示例：

  		-- 从1加到100
  		sum = 0
  		for i = 1, 100 do
  			sum = sum + i
  		end
  		-- 从1到100的奇数和
  		sum = 0
  		for i = 1, 100, 2 do
  			sum = sum + i
  		end
  		-- 计算大于1000的最小的2的幂
  		sum = 2
  		repeat
  			sum = sum ^ 2
  		until sum > 1000
  		print (sum)
  		-- 从1加到100
  		sum = 0
  		num = 1
  		while(num <= 100)
  		do
  			sum = sum + num
  			num = num + 1
  		end

  * 用elseif关键字表示else if
  * 在使用==和~=进行比较时，只有数字和字符串比较的是值，其余类型都比较引用
  * 没有列表和字典的说法，统一称为table，可以实现列表和字典的功能
  * 遍历表的时候需要注意ipairs和pairs的区别：

  		local tb = {[3] = "test2", [6] = "test3", [1] = "test1"}
  		-- 使用ipairs时，从下标为1开始逐一找并执行，直到遇到nil返回0值
  		for k, v in ipairs(tb) do
  			print(k, v)
  		end
  		-- 将只输出1和test1，因为key=2时value就是nil，导致跳出返回
  		-- 使用pairs时将遍历所有key，且在遍历结束后返回nil
  		for k, v in pairs(tb) do
  			print(k, v)
  		end
  		-- 将输出所有的key和value，且顺序与列表中的顺序相同，如本例则为3、6、1


### 一些奇怪的特性

  * 数字只有64位双精度浮点数类型
  * 变量默认为全局变量，除非在前面加关键字local（与python相反）
  * 既没有++也没有+=
  * 用#array来表示数组array的长度（只统计所有下标为整数的元素个数）
  * 在定义某个“类“的成员函数时，function class.function(self, p)与function class:function(p)是等价的，在调用函数时也可这么用
  * 用表实现字典功能的trick：

  		x = 1
  		t = {x=1.1, [x]=1}
  		print(t["x"])    // get 1.1
  		print(t[1])        // get 1

### lua的面向对象与类的实现

  * 这个有点难表述……先空着吧


